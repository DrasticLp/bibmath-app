<!doctype html><html lang="fr"<head><script async src="https://tags.refinery89.com/v2/bibmathnet.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-CTYE0T3DYG"></script><script>window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'G-CTYE0T3DYG');</script>
<meta charset="utf-8"><meta name="Author" CONTENT="Fred Bayart"><meta name="Description" CONTENT="Les codes d'authentification de message - MAC"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Les codes d'authentification de message - MAC</title><link type="text/css" href="css/cryptostyle.css" rel="stylesheet" /><script type="text/x-mathjax-config">
MathJax.Hub.Config({  tex2jax: {inlineMath: [['$','$']]} });</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script><script type="text/javascript" src="common/fonctions.js"></script><script src="common/spoiler.js"></script></head><body><header id="bandeau"><div id="bandeaucentre"><span id=bandeaulogo>Cryptographie et codes secrets</span><span id=bandeaumilieu><a href="https://www.facebook.com/bibmath" alt="Consulter notre page FaceBook" title="Consulter notre page Facebook">
	<img src="img/fb.png" /></a></span><div id=bandeaurecherche><form id="formrech" name="recherche" action="https://www.bibmath.net/crypto/recherche.php"  method="get"><input name="q" placeholder="Rechercher sur le site..." class="formulairerecherche inputrecherche" /><button class="formulairerecherche boutonrecherche" value="" title="Rechercher"> </button></form></div></div></header><header id="bandeaumobile"><div class="sousbandeaumobile"><span class="itembandeaumobile" id="iconeouvremenu"><a href="javascript:ouvremenumobile()">
	<img src="img/menumobile.png" /></a></span>
	<span class="itembandeaumobilefondnoir" id="iconefermemenu"><a href="javascript:fermemenumobile()"><img src="img/deletemobile.png">
	</a></span><span class="itembandeaumobile">Cryptographie!</span></div><div class="sousbandeaumobile"><span class="itembandeaumobile"><a href="https://www.bibmath.net/forums/index.php" title="Accéder au forum du site">
	<img src="img/forumgrand.png" /></a></span>
	<span class="itembandeaumobilesansbordure"><a href="https://www.facebook.com/bibmath" alt="Consulter notre page FaceBook" 
	title="Consulter notre page Facebook"><img src="img/fbmobile.png" /></a></span>
	<span class="itembandeaumobile"  id="iconeouvrerecherche"><a href="javascript:ouvrerecherchemobile()">
	<img src="img/loupemobile.png" /></a></span>
	<span class="itembandeaumobilefondnoir" id="iconefermerecherche"><a href="javascript:fermerecherchemobile()">
	<img src="img/deletemobile.png"></a></span></div></header><div id="recherchemobile"><form id="formrecherchemobile" name="recherche" action="https://www.bibmath.net/crypto/recherche.php"  method="get"><div class="divinputrecherche"><input name="q" placeholder="Rechercher sur le site..." class="formulairerecherche inputrecherche" /></div><div class="divboutonmobile"><button class="formulairerecherche boutonrecherche" value="" title="Rechercher"> </button></div></form></div><div id="menuetsousmenu"><nav id="menuhaut"><div id="menuhautcentre"><section id="listemenuhaut"><span id="menu0" class="item"><a href="Analyse.class.html">Accueil</a></span><span id="menu1" class="itemselectionne"><a href="index.php%3Faction=affiche&amp;quoi=ancienne%252Findex.html">Méthodes anciennes</a></span><span id="menu2" class="item"><a href="index.php%3Faction=affiche&amp;quoi=debvingt%252Findex.html">Les 2 guerres</a></span><span id="menu3" class="item"><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findex.html">Méthodes modernes</a></span><span id="menu4" class="item"><a href="https://www.bibmath.net/crypto/index.php?action=affiche&amp;quoi=chasseur/index">Chasseurs de codes</a></span><span id="menu5" class="item"><a href="index.php%3Faction=affiche&amp;quoi=stegano%252Findex.html">Stéganographie</a></span><span id="menu6" class="item"><a href="index.php%3Faction=affiche&amp;quoi=complements%252Findex.html">Compléments</a></span><span id="menu7" class="item"><a href="index.php%3Faction=affiche&amp;quoi=lexique.html">Lexique</a></span><span id="menu8" class="item"><a href="https://www.bibmath.net/forums/viewforum.php?id=6">Forum</a></span></section></div></nav><nav id="menumobile"><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="Analyse.class.html">Accueil</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme0"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert0"  style="display:none;"/></div></div><div class="itemmenumobileselectionne"><div class="teteitemmenumobile"><span><a href="javascript:affiche_sousmenumobile(1);">Méthodes anciennes</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme1"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert1"  style="display:none;"/></div><div class="sousmenumobile" id="sousmenumobile1"><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=substi%252Findex.html">Substitution monoalphabétique</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=poly%252Findex.html">Substitution polyalphabétique</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=ancienne%252Fpolygraphiqueindex.html">Chiffres polygraphiques</a></span></div><div class="sousitemmenumobile"><span><a href="https://www.bibmath.net/crypto/index.php?action=affiche&amp;quoi=ancienne/homophoneindex">Chiffres homophones</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=ancienne%252Ftranspoindex.html">Transposition</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=ancienne%252Fsurchiffrement.html">Surchiffrement</a></span></div></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="javascript:affiche_sousmenumobile(2);">Les 2 guerres</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme2"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert2"  style="display:none;"/></div><div class="sousmenumobile" id="sousmenumobile2"><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=debvingt%252Findexpremguerre.html">Première Guerre Mondiale</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=debvingt%252Findexsecguerre.html">Deuxième Guerre Mondiale</a></span></div></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="javascript:affiche_sousmenumobile(3);">Méthodes modernes</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme3"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert3"  style="display:none;"/></div><div class="sousmenumobile" id="sousmenumobile3"><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findex.html">Préambule</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findexclesecrete.html">Clé secrète</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findexclepublique.html">Clé publique</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findexprotocole.html">Protocoles</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findexconcret.html">Mises en oeuvre</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findexfutur.html">Futur</a></span></div></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="javascript:affiche_sousmenumobile(4);">Chasseurs de codes</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme4"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert4"  style="display:none;"/></div><div class="sousmenumobile" id="sousmenumobile4"><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=chasseur%252Findextheorie.html">Quelques principes</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=chasseur%252Findexvaincre.html">Quelques cas concrets</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=chasseur%252Findexoutils.html">Outils</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=chasseur%252Findexenigmes.html">Enigmes</a></span></div></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=stegano%252Findex.html">Stéganographie</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme5"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert5"  style="display:none;"/></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="javascript:affiche_sousmenumobile(6)">Compléments</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme6"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert6"  style="display:none;"/></div><div class="sousmenumobile" id="sousmenumobile6"><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=complements%252Findexfigures.html">Portraits</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=complements%252Findexmaths.html">Compléments mathématiques</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=complements%252Findexinfo.html">Compléments informatique</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=complements%252Findexclasse.html">En classe</a></span></div></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=lexique.html">Lexique</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme7"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert7"  style="display:none;"/></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="https://www.bibmath.net/forums/viewforum.php?id=6">Forum</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme8"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert8"  style="display:none;"/></div></div></nav></div><div id="main"><div style="width:100%"><div id="pubhaut"></div></div><div id="maincentre"><div id="gauche"><article id="contenugauche"><div class="chemin"><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findex.html">Le plan de la partie : méthodes modernes de cryptographie</a> &gt; </div><h1>Les codes d'authentification de message - MAC</h1><div class=titrepartie>Description</div>
&nbsp;&nbsp;<font size=+2>L</font>es codes d'authentification de message, plus connus sous l'acronyme MAC,
de l'anglais <span class=rougedico>M</span>essage <span class=rougedico>A</span>uthentification <span class=rougedico>
C</span>ode, sont des fonctions cryptographiques destinées à vérifier l'intégrité de données et à en authentifier l'origine.
Ces MAC fonctionnent comme les fonctions de hachage : ils calculent à partir d'un message de longueur arbitraire 
un résumé de longueur fixe (on appelle ce résumé un haché). Mais, contrairement aux fonctions de hachage, ce résumé dépend aussi 
d'une clé secrète $K$.</p>
&nbsp;&nbsp;<font size=+2>V</font>oici une application naturelle des codes d'authentification de message. Imaginons que, pour prévenir
les virus, vous gardiez une version hachée de chaque fichier système sur votre ordinateur. Ainsi, si un virus 
modifie le fichier système, vous pourrez vous en apercevoir car les versions hachées ne coïncideront plus. 
Mais si le virus est un peu malin, il changera aussi la version hachée, et vous ne pourrez plus vous rendre compte
de rien. Ce n'est plus possible si, au lieu de stocker une version hachée, vous stockez un 
code d'authenfication. En effet, ce code dépend d'une clé secrète que vous êtes le seul à connaitre. Ainsi, 
si le virus modifie le fichier système, il ne pourra pas calculer le code d'authentification correspondant
(car il ne connait pas la clé); et vous pourrez détecter la modification!</p>
&nbsp;&nbsp;<font size=+2>U</font>n code d'authentification de message est donc une fonction 
$h(M,K)$ où $M$ est le message et $K$ est la clé, qui renvoie un texte de longueur fixe.
 Il doit vérifier les propriétés suivantes :
<div class=liste>
<ul>
<li>il est très rapide de calculer $h(M,K)$;
<li>mais si on connait des exemples de code calculés avec la même clé, 
disons $h(M_1,K),\dots, h(M_n,K)$, si on dispose d'un nouveau message $M$,
mais pas de la clé $K$, on ne peut pas calculer $h(M,K)$. 
</ul>
</div>
&nbsp;&nbsp;<font size=+2>L</font>ors d'une communication entre individus, on utilise les codes d'authentification de
message de la façon suivante. Expéditeur et destinataire commencent par se mettre d'accord
sur une clé secrète, par un canal sécurisé. L'expéditeur, lorsqu'il veut envoyer un message M, calcule
son MAC à l'aide de la clé secrète, et envoie conjointement le message M et son code MAC. A l'arrivée,
le destinataire calcule lui aussi le MAC à l'aide de sa propre secrète, et le compare avec la version envoyée.
Si les deux coïncident, il est sûr à la fois de qui lui a expédié le message et aussi que ce message
n'a pas été modifié. Sinon, c'est que quelque chose ne va pas!</p>
<center><img src="moderne/images/mac.png"></center></p>


<div class=titrepartie>Comment fabriquer un code d'authentification de message?</div>
&nbsp;&nbsp;<font size=+2>U</font>n des moyens classiques de fabriquer un code d'authentification de message
est d'utiliser un algorithme de chiffrement par blocs, comme AES, en mode CBC (chiffrement par chainage de blocs).
Rappelons comment fonctionne ce mode. On dispose d'un algorithme $C_K$ dépendant de la clé $K$ et chiffrant des
blocs de $n$ bits. Le message $M$ est partagé en blocs de $k$ bits chacun, $m_1\dots m_r$. On dispose
également d'un vecteur d'initialisation $c_0$. On calcule alors successivement, et par récurrence, 
les chiffrés $c_i=C_K(c_{i-1}\oplus m_i)$.</p>
&nbsp;&nbsp;<font size=+2>L'</font>avantage de ce mode de chiffrement est que tous les blocs chiffrés dépendent du précédent. En
particulier, le dernier bloc $c_r$ dépend de tout le message (et pas uniquement du dernier bloc). Ainsi, ce bloc
peut servir de MAC pour le message $M$. Pour plus de sécurité (ce protocole comporte en effet une faiblesse
lorsque l'on traite des concaténations de messages), on chiffre ce dernier bloc $c_r$ pour en faire le réel MAC du message.
On parle alors de EMAC, pour Encrypted Mac.</p>
<center><img src="moderne/images/cbc.png"></center>
</p>
&nbsp;&nbsp;<font size=+2>U</font>ne autre façon de construire un code d'authentification de message est d'utiliser une fonction 
de hachage. On parle alors de HMAC. Cela peut sembler étonnant, puisqu'un code d'authentification de message doit dépendre d'une clé, alors que ce n'est
pas le cas d'une fonction de hachage. D'ailleurs, il est très facile de faire le contraire, c'est-à-dire de produire
une fonction de hachage à partir d'un code d'authentification de message. Il suffit d'appliquer ce dernier
avec une clé fixe.</p>
&nbsp;&nbsp;<font size=+2>V</font>oici donc comment procéder. On suppose donc qu'on a une fonction de hachage $H$ qui 
fournit un résumé de taille $l$ bits, et qui procède en interne par blocs de $B$ bits. On veut fabriquer un code d'authentification de message $m$
qui fonctionne avec une clé $K$ de moins de $B$ bits.
<ol>
<li>On commence par compléter $K$ avec des 0 de sorte qu'il fasse exactement $B$ bits.
<li>On calcule $H\big(K\oplus \textrm{opad}\|H(K\oplus\textrm{ipad}\|m) \big)$ où 
$\textrm{opad}$ et $\textrm{ipad}$ sont des chaines fixes de $B$ bits et $m_1\|m_2$ 
désigne la concaténation des deux messages $m_1$ et $m_2$.
<li>On tronque le résultat au $t$ bits les plus à gauche. Le résultat est $HMAC_K(m)$.
</ol>


<div class=titrepartie>Consulter aussi</div><div class=liste><ul><li><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Fsigelec.html">Les fonctions de hachage</a></li><li><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Fblocs.html">Modes de fonctionnement des chiffrements par blocs</a></li></ul></div></article></div><aside id="droite"><div id="pubdroite"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:600px"
     data-ad-client="ca-pub-5238512654171693"
     data-ad-slot="3610567220"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></aside></div></div><footer id="pied"><div id="piedcentre"><section id="listepied"><span class="item"><a href="contact.php%3Forigine=erreur.html">Signaler une erreur, une faute d'orthographe</a></span><span class="item"><a href="contact.php%3Forigine=contribuer.html">Contribuer au site</a></span><span class="item"><a href="credits.php.html">Crédits</a></span></section></div></footer><footer id="piedmobile"><span class="item"><script language="JavaScript1.1"> <!-- 
	hsh = new Date();
      hsd = document;
      hsi = '<a href="http://www.xiti.com/xiti.asp?s=65164"'
      hsi += ' TARGET="_top"><img width="80" height="15" border=0 '
      hsi += 'src="http://logv17.xiti.com/oco.xiti?s=65164'
      hsi += '&p=&hl=' + hsh.getHours() + 'x' + hsh.getMinutes() + 'x' + hsh.getSeconds();
      if(parseFloat(navigator.appVersion)>=4)
            {Xiti_s=screen;hsi += '&r=' + Xiti_s.width + 'x' + Xiti_s.height + 'x' + Xiti_s.pixelDepth + 'x' + Xiti_s.colorDepth;}
      hsd.writeln(hsi + '&ref=' + hsd.referrer.replace('&', '$') + ' " title="Mesurez votre audience"></a>');//-->  
      </script></span><span class="item"><a href="contact.php%3Forigine=mobile.html">Nous contacter</a></span></footer></body><script type="text/javascript" src="common/scrolling.js"></script></html>   
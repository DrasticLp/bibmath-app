<!doctype html><html lang="fr"<head><script async src="https://tags.refinery89.com/v2/bibmathnet.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-CTYE0T3DYG"></script><script>window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'G-CTYE0T3DYG');</script>
<meta charset="utf-8"><meta name="Author" CONTENT="Fred Bayart"><meta name="Description" CONTENT="La sécurité des connexions Bluetooth"><meta name="viewport" content="width=device-width, initial-scale=1"><title>La sécurité des connexions Bluetooth</title><link type="text/css" href="css/cryptostyle.css" rel="stylesheet" /><script type="text/x-mathjax-config">
MathJax.Hub.Config({  tex2jax: {inlineMath: [['$','$']]} });</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script><script type="text/javascript" src="common/fonctions.js"></script><script src="common/spoiler.js"></script></head><body><header id="bandeau"><div id="bandeaucentre"><span id=bandeaulogo>Cryptographie et codes secrets</span><span id=bandeaumilieu><a href="https://www.facebook.com/bibmath" alt="Consulter notre page FaceBook" title="Consulter notre page Facebook">
	<img src="img/fb.png" /></a></span><div id=bandeaurecherche><form id="formrech" name="recherche" action="https://www.bibmath.net/crypto/recherche.php"  method="get"><input name="q" placeholder="Rechercher sur le site..." class="formulairerecherche inputrecherche" /><button class="formulairerecherche boutonrecherche" value="" title="Rechercher"> </button></form></div></div></header><header id="bandeaumobile"><div class="sousbandeaumobile"><span class="itembandeaumobile" id="iconeouvremenu"><a href="javascript:ouvremenumobile()">
	<img src="img/menumobile.png" /></a></span>
	<span class="itembandeaumobilefondnoir" id="iconefermemenu"><a href="javascript:fermemenumobile()"><img src="img/deletemobile.png">
	</a></span><span class="itembandeaumobile">Cryptographie!</span></div><div class="sousbandeaumobile"><span class="itembandeaumobile"><a href="https://www.bibmath.net/forums/index.php" title="Accéder au forum du site">
	<img src="img/forumgrand.png" /></a></span>
	<span class="itembandeaumobilesansbordure"><a href="https://www.facebook.com/bibmath" alt="Consulter notre page FaceBook" 
	title="Consulter notre page Facebook"><img src="img/fbmobile.png" /></a></span>
	<span class="itembandeaumobile"  id="iconeouvrerecherche"><a href="javascript:ouvrerecherchemobile()">
	<img src="img/loupemobile.png" /></a></span>
	<span class="itembandeaumobilefondnoir" id="iconefermerecherche"><a href="javascript:fermerecherchemobile()">
	<img src="img/deletemobile.png"></a></span></div></header><div id="recherchemobile"><form id="formrecherchemobile" name="recherche" action="https://www.bibmath.net/crypto/recherche.php"  method="get"><div class="divinputrecherche"><input name="q" placeholder="Rechercher sur le site..." class="formulairerecherche inputrecherche" /></div><div class="divboutonmobile"><button class="formulairerecherche boutonrecherche" value="" title="Rechercher"> </button></div></form></div><div id="menuetsousmenu"><nav id="menuhaut"><div id="menuhautcentre"><section id="listemenuhaut"><span id="menu0" class="item"><a href="Analyse.class.html">Accueil</a></span><span id="menu1" class="itemselectionne"><a href="index.php%3Faction=affiche&amp;quoi=ancienne%252Findex.html">Méthodes anciennes</a></span><span id="menu2" class="item"><a href="index.php%3Faction=affiche&amp;quoi=debvingt%252Findex.html">Les 2 guerres</a></span><span id="menu3" class="item"><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findex.html">Méthodes modernes</a></span><span id="menu4" class="item"><a href="https://www.bibmath.net/crypto/index.php?action=affiche&amp;quoi=chasseur/index">Chasseurs de codes</a></span><span id="menu5" class="item"><a href="index.php%3Faction=affiche&amp;quoi=stegano%252Findex.html">Stéganographie</a></span><span id="menu6" class="item"><a href="index.php%3Faction=affiche&amp;quoi=complements%252Findex.html">Compléments</a></span><span id="menu7" class="item"><a href="index.php%3Faction=affiche&amp;quoi=lexique.html">Lexique</a></span><span id="menu8" class="item"><a href="https://www.bibmath.net/forums/viewforum.php?id=6">Forum</a></span></section></div></nav><nav id="menumobile"><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="Analyse.class.html">Accueil</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme0"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert0"  style="display:none;"/></div></div><div class="itemmenumobileselectionne"><div class="teteitemmenumobile"><span><a href="javascript:affiche_sousmenumobile(1);">Méthodes anciennes</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme1"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert1"  style="display:none;"/></div><div class="sousmenumobile" id="sousmenumobile1"><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=substi%252Findex.html">Substitution monoalphabétique</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=poly%252Findex.html">Substitution polyalphabétique</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=ancienne%252Fpolygraphiqueindex.html">Chiffres polygraphiques</a></span></div><div class="sousitemmenumobile"><span><a href="https://www.bibmath.net/crypto/index.php?action=affiche&amp;quoi=ancienne/homophoneindex">Chiffres homophones</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=ancienne%252Ftranspoindex.html">Transposition</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=ancienne%252Fsurchiffrement.html">Surchiffrement</a></span></div></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="javascript:affiche_sousmenumobile(2);">Les 2 guerres</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme2"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert2"  style="display:none;"/></div><div class="sousmenumobile" id="sousmenumobile2"><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=debvingt%252Findexpremguerre.html">Première Guerre Mondiale</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=debvingt%252Findexsecguerre.html">Deuxième Guerre Mondiale</a></span></div></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="javascript:affiche_sousmenumobile(3);">Méthodes modernes</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme3"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert3"  style="display:none;"/></div><div class="sousmenumobile" id="sousmenumobile3"><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findex.html">Préambule</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findexclesecrete.html">Clé secrète</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findexclepublique.html">Clé publique</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findexprotocole.html">Protocoles</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findexconcret.html">Mises en oeuvre</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findexfutur.html">Futur</a></span></div></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="javascript:affiche_sousmenumobile(4);">Chasseurs de codes</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme4"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert4"  style="display:none;"/></div><div class="sousmenumobile" id="sousmenumobile4"><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=chasseur%252Findextheorie.html">Quelques principes</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=chasseur%252Findexvaincre.html">Quelques cas concrets</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=chasseur%252Findexoutils.html">Outils</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=chasseur%252Findexenigmes.html">Enigmes</a></span></div></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=stegano%252Findex.html">Stéganographie</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme5"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert5"  style="display:none;"/></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="javascript:affiche_sousmenumobile(6)">Compléments</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme6"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert6"  style="display:none;"/></div><div class="sousmenumobile" id="sousmenumobile6"><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=complements%252Findexfigures.html">Portraits</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=complements%252Findexmaths.html">Compléments mathématiques</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=complements%252Findexinfo.html">Compléments informatique</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=complements%252Findexclasse.html">En classe</a></span></div></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=lexique.html">Lexique</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme7"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert7"  style="display:none;"/></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="https://www.bibmath.net/forums/viewforum.php?id=6">Forum</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme8"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert8"  style="display:none;"/></div></div></nav></div><div id="main"><div style="width:100%"><div id="pubhaut"></div></div><div id="maincentre"><div id="gauche"><article id="contenugauche"><div class="chemin"><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findex.html">Le plan de la partie : méthodes modernes de cryptographie</a> &gt; </div><h1>La sécurité des connexions Bluetooth</h1><div class=titrepartie>Historique et description générale</div>
&nbsp;&nbsp;<font size=+2>C'</font>est dans les années 1990 qu'est venue l'idée que des périphériques, reliés auparavant par des fils
(comme le clavier et la souris d'un ordinateur, le casque d'une chaine hifi, les manettes d'une console de jeu)
pourraient désormais communiquer avec leur hôte en utilisant des ondes radio. C'est la société suédoise
Ericsson qui développa la première cette technologie baptisée Bluetooth en 1994, rejointe peu après dans un consortium
par IBM, Intel, Nokia et Toshiba. La norme 1.0 du Bluetooth est publiée en juillet 1999, et en 2012, le consortium
regroupait plus de 16000 sociétés. Les applications du Bluetooth ont largement dépassé le cadre prévu initialement, désormais
on connecte son téléphone mobile à sa voiture par cette technologie.</p>
&nbsp;&nbsp;Le nom Bluetooth vient du roi danois Harald Blåtand, que l'on écrit Harold Bluetooth en anglais, qui vécut au Xième siècle.
 Ce roi avait beaucoup oeuvré dans sa vie afin d'unifier des parties de ce qui sont maintenant le Danemark, la Norvège et la Suède, 
 exactement comme la technologie Bluetooth a pour but de faire dialoguer des appareils très différents. Le logo de Bluetooth célèbre
 lui aussi Harald Bluetooth, puisqu'il est constitué en caractères runniques des initiales HB du roi.</p>
 <center><img src="moderne/images/bluetooth_logo.png"></center>
&nbsp;&nbsp;Les spécifications du Bluetooth sont les suivantes :
<div class=liste>
<ul>
<li>très faible consommation d'énergie
<li>très faible portée (sur un rayon de l'ordre d'une dizaine de mètres)
<li>faible débit
<li>très bon marché et peu encombrant.
</ul>
</div>
&nbsp;&nbsp;Lorsque deux objets équipés de la technologie Bluetooth veulent communiquer, ils doivent suivre un protocole en trois points :
<div class=liste>
<ul>
<li>l'appariement (pairing en anglais) : les deux objets doivent se reconnaitre comme étant équipés de la technologie Bluetooth
et ils préparent les communications futures en s'échangeant un certain nombre d'informations. L'appariement ne doit être réalisé qu'une seule
fois, et il nécessite dans l'idéal une intervention humaine externe.
<li>l'authentification : à chaque fois que les objets veulent communiquer (par exemple, chaque fois que vous rentrez avec votre mobile dans
votre voiture), les deux objets doivent s'identifier l'un à l'autre et vérifier qu'ils ont bien le droit de communiquer (il ne faudrait pas que
l'oreillette de votre téléphone portable envoie vos données au téléphone portable du voisin!)
<li>l'échange de données.
</ul>
</div>
&nbsp;&nbsp;Nous détaillons maintenant chaque étape, sans rentrer dans le détail technique des algorithmes utilisés (la spécification complète du 
Bluetooth comporte plus de 1200 pages!).
<div class=titrepartie>L'appariement de deux périphériques</div>
&nbsp;&nbsp;<font size=+2>C'</font>est le point le plus important dans la sécurité du Bluetooth. D'abord, les deux objets doivent être mis dans un état
de recherche de périphériques Bluetooth à proximité. Une fois le dialogue amorcé, les deux s'accordent pour que l'un soit le maitre, et l'autre soit l'esclave,
mais le fait d'être maitre ou esclave n'a pas d'importance.</p>
&nbsp;&nbsp;Le propriétaire des objets intervient d'abord en rentrant un code d'identification (on dit aussi code PIN), le plus souvent
à 4 chiffres, sur chacun des objets. Puis, le maitre choisit au hasard un nombre aléatoire $N$, et il l'envoie à l'esclave. L'esclave
et le maitre calculent $K_{init}=E22(N,PIN)$, où $E22$ est une certaine fonction décrite dans le protocole du Bluetooth. $K_{init}$ est 
une clé d'échange provisoire que les deux objets possèdent en commun, et qui sécurise les échanges à venir.</p>
&nbsp;&nbsp;Ce faisant, les deux objets n'ont pas encore vérifié qu'ils possédaient le même code PIN. Le maitre et l'esclave choisissent
chacun un autre nombre aléatoire, disons $A_M$ pour le maitre et $A_E$ pour l'esclave. Le maitre envoie $A_M$ à l'esclave 
et l'esclave envoie $A_E$ au maitre. Le maitre et l'esclave calculent tous deux $C_M=A_M\oplus K_{init}$ et $C_E=A_E\oplus K_{init}$.
Le maitre envoie à l'esclave $C_E$. L'esclave compare à la valeur qu'il a lui-même calculé. Si elles coincident, il sait que
le maitre a eu le même code PIN que lui, et donc il peut continuer l'appariement. Réciproquement, l'esclave envoie
$C_M$ au maitre. Celui-ci compare avec la valeur qu'il a lui-même calculé. Si elles coincident, l'esclave a eu le même code PIN,
et les deux objets ont le droit de dialoguer.</p>
&nbsp;&nbsp;Le processus d'appariement n'est pas fini. Les deux objets calculent à partir de $A_E$, $A_M$ (qu'ils connaissent tous deux, 
mais qu'ils se sont échangés de façon sécurisée grâce à $K_{init}$) et de leurs adresses physiques (nombre unique créé à leur fabrication)
une clé d'authentification commune $K_{auth}$. Ils stockent ensuite cette clé dans une petite mémoire. Le processus d'appariement est terminé
et n'aura pas besoin d'être renouvelé.</p>
<center><img src="moderne/images/bluetooth1.png"></center></p>
&nbsp;&nbsp;Dans les versions plus récentes du protocole, l'intervention d'un homme n'est plus nécessaire que pour mettre
les deux appareils en état de recherche d'appariement, mais l'utilisation du code PIN n'est plus nécessaire.
 Les deux objets s'échangent en effet une clé d'initialisation
à l'aide d'un protocole proche de celui de <a href="index.php%3Faction=affiche&amp;quoi=moderne%252Fdifhel.html">Diffie-Helman</a> où on peut s'échanger
une clé sans se la communiquer, et sans qu'un tiers qui écoute tous les échanges puisse la découvrir!



<div class=titrepartie>L'authentification</div>
&nbsp;&nbsp;<font size=+2>O</font>n se place désormais dans le cadre où deux appareils possédant la technologie Bluetooth ont déjà été
appariés. Ils partagent donc tous les deux la même clé d'authentification $K_{auth}$. Après un moment où ils ont été séparés,
on les présente à nouveau l'un à l'autre. Comment reprennent-ils leur conversation?</p>
&nbsp;&nbsp;Le point clé est qu'ils doivent s'authentifier l'un à l'autre, c'est-à-dire vérifier qu'on leur a bien donner l'autorisation
de dialoguer. Plus concrètement, ils doivent vérifier qu'ils possèdent la même clé $K_{auth}$. C'est à nouveau un procédé de <a href="index.php%3Faction=affiche&amp;quoi=moderne%252Fidentification.html">challenge</a>
(ou de question/réponse) à base de nombres aléatoires qui va donner la solution. </p>
&nbsp;&nbsp;Le maitre choisit un nombre au hasard, que je vais noter $Aut_M$. Il l'envoie à l'esclave. Celui calcule une réponse
$Rep_E$ qui dépend à la fois de la clé d'authentification $K_{auth}$ et de $Aut_M$. Il utilise pour cela un certain algorithme $E1$,
et on a donc $Rep_E=E1(K_{auth},Aut_M)$. Il retourne $Rep_E$ au maitre. Celui-ci a, pendant ce temps-là, calculé également à quoi 
doit être égal $Rep_E$. Si la valeur reçue et la valeur calculée sont égales, il a bien authentifié l'esclave.</p>
&nbsp;&nbsp;Le procédé se poursuit alors de façon symétrique. Cette fois, c'est l'esclave qui choisit un nombre au hasard,
que je note $Aut_E$. Il l'envoie au maitre qui calcule, avec le même algorithme, $Rep_M=E1(K,Aut_E)$. Il envoie cette réponse
à l'esclave qui a calculé cette valeur entretemps. Si les deux valeurs coïncident, l'esclave a authentifié le maitre. L'authentification
est alors terminée et les deux appareils vont pouvoir passer aux choses sérieuses : l'échange de données.</p>
<center><img src="moderne/images/bluetooth2.png"></center></p>

<div class=titrepartie>L'échange de données</div>
&nbsp;&nbsp;<font size=+2>L'</font>échange de données est finalement la partie la plus facile de la communication Bluetooth.
Une fois qu'ils se sont authentifiés, les deux appareils s'échangent une clé de communication, générée par un algorithme appelé $E3$
à partir de la clé d'authentification $K_{auth}$ et d'une valeur aléatoire. Les données envoyées sont chiffrées ensuite
à l'aide d'un algorithme de <a href="index.php%3Faction=affiche&amp;quoi=moderne%252Fflots.html">chiffrement par flots</a>, l'horloge du maitre
jouant le rôle de nunique.

<div class=titrepartie>Des failles dans la sécurité</div>
&nbsp;&nbsp;<font size=+2>C</font>omme expliqué ci-dessus, la sécurité du Bluetooth dépend pour beaucoup 
de la phase d'authentification. Malheureusement, il est souvent impossible de la réaliser dans des conditions idéales.
Par exemple, une oreillette n'a pas de clavier pour rentrer un code PIN. Dans ce cas, l'oreillette impose d'utiliser un code PIN
fixé en usine, qui est souvent 0000 ou 1234!</p>
&nbsp;&nbsp;<font size=+2>P</font>arfois même, certains produits bas de gamme imposent une clé d'authentification fixe. Dans ce cas,
si on vous emprunte quelques secondes votre oreillette, on pourra découvrir cette clé d'authentification, puis espionner les communications
futures de cette oreillette avec n'importe quel autre appareil Bluetooth!
</article></div><aside id="droite"><div id="pubdroite"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:600px"
     data-ad-client="ca-pub-5238512654171693"
     data-ad-slot="3610567220"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></aside></div></div><footer id="pied"><div id="piedcentre"><section id="listepied"><span class="item"><a href="contact.php%3Forigine=erreur.html">Signaler une erreur, une faute d'orthographe</a></span><span class="item"><a href="contact.php%3Forigine=contribuer.html">Contribuer au site</a></span><span class="item"><a href="credits.php.html">Crédits</a></span></section></div></footer><footer id="piedmobile"><span class="item"><script language="JavaScript1.1"> <!-- 
	hsh = new Date();
      hsd = document;
      hsi = '<a href="http://www.xiti.com/xiti.asp?s=65164"'
      hsi += ' TARGET="_top"><img width="80" height="15" border=0 '
      hsi += 'src="http://logv17.xiti.com/oco.xiti?s=65164'
      hsi += '&p=&hl=' + hsh.getHours() + 'x' + hsh.getMinutes() + 'x' + hsh.getSeconds();
      if(parseFloat(navigator.appVersion)>=4)
            {Xiti_s=screen;hsi += '&r=' + Xiti_s.width + 'x' + Xiti_s.height + 'x' + Xiti_s.pixelDepth + 'x' + Xiti_s.colorDepth;}
      hsd.writeln(hsi + '&ref=' + hsd.referrer.replace('&', '$') + ' " title="Mesurez votre audience"></a>');//-->  
      </script></span><span class="item"><a href="contact.php%3Forigine=mobile.html">Nous contacter</a></span></footer></body><script type="text/javascript" src="common/scrolling.js"></script></html>   
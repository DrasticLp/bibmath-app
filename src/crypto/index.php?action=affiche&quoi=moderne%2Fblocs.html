<!doctype html><html lang="fr"<head><script async src="https://tags.refinery89.com/v2/bibmathnet.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-CTYE0T3DYG"></script><script>window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'G-CTYE0T3DYG');</script>
<meta charset="utf-8"><meta name="Author" CONTENT="Fred Bayart"><meta name="Description" CONTENT="Les chiffrements par blocs - Leur modes opératoires"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Les chiffrements par blocs - Leur modes opératoires</title><link type="text/css" href="css/cryptostyle.css" rel="stylesheet" /><script type="text/x-mathjax-config">
MathJax.Hub.Config({  tex2jax: {inlineMath: [['$','$']]} });</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script><script type="text/javascript" src="common/fonctions.js"></script><script src="common/spoiler.js"></script></head><body><header id="bandeau"><div id="bandeaucentre"><span id=bandeaulogo>Cryptographie et codes secrets</span><span id=bandeaumilieu><a href="https://www.facebook.com/bibmath" alt="Consulter notre page FaceBook" title="Consulter notre page Facebook">
	<img src="img/fb.png" /></a></span><div id=bandeaurecherche><form id="formrech" name="recherche" action="https://www.bibmath.net/crypto/recherche.php"  method="get"><input name="q" placeholder="Rechercher sur le site..." class="formulairerecherche inputrecherche" /><button class="formulairerecherche boutonrecherche" value="" title="Rechercher"> </button></form></div></div></header><header id="bandeaumobile"><div class="sousbandeaumobile"><span class="itembandeaumobile" id="iconeouvremenu"><a href="javascript:ouvremenumobile()">
	<img src="img/menumobile.png" /></a></span>
	<span class="itembandeaumobilefondnoir" id="iconefermemenu"><a href="javascript:fermemenumobile()"><img src="img/deletemobile.png">
	</a></span><span class="itembandeaumobile">Cryptographie!</span></div><div class="sousbandeaumobile"><span class="itembandeaumobile"><a href="https://www.bibmath.net/forums/index.php" title="Accéder au forum du site">
	<img src="img/forumgrand.png" /></a></span>
	<span class="itembandeaumobilesansbordure"><a href="https://www.facebook.com/bibmath" alt="Consulter notre page FaceBook" 
	title="Consulter notre page Facebook"><img src="img/fbmobile.png" /></a></span>
	<span class="itembandeaumobile"  id="iconeouvrerecherche"><a href="javascript:ouvrerecherchemobile()">
	<img src="img/loupemobile.png" /></a></span>
	<span class="itembandeaumobilefondnoir" id="iconefermerecherche"><a href="javascript:fermerecherchemobile()">
	<img src="img/deletemobile.png"></a></span></div></header><div id="recherchemobile"><form id="formrecherchemobile" name="recherche" action="https://www.bibmath.net/crypto/recherche.php"  method="get"><div class="divinputrecherche"><input name="q" placeholder="Rechercher sur le site..." class="formulairerecherche inputrecherche" /></div><div class="divboutonmobile"><button class="formulairerecherche boutonrecherche" value="" title="Rechercher"> </button></div></form></div><div id="menuetsousmenu"><nav id="menuhaut"><div id="menuhautcentre"><section id="listemenuhaut"><span id="menu0" class="item"><a href="Analyse.class.html">Accueil</a></span><span id="menu1" class="itemselectionne"><a href="index.php%3Faction=affiche&amp;quoi=ancienne%252Findex.html">Méthodes anciennes</a></span><span id="menu2" class="item"><a href="index.php%3Faction=affiche&amp;quoi=debvingt%252Findex.html">Les 2 guerres</a></span><span id="menu3" class="item"><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findex.html">Méthodes modernes</a></span><span id="menu4" class="item"><a href="https://www.bibmath.net/crypto/index.php?action=affiche&amp;quoi=chasseur/index">Chasseurs de codes</a></span><span id="menu5" class="item"><a href="index.php%3Faction=affiche&amp;quoi=stegano%252Findex.html">Stéganographie</a></span><span id="menu6" class="item"><a href="index.php%3Faction=affiche&amp;quoi=complements%252Findex.html">Compléments</a></span><span id="menu7" class="item"><a href="index.php%3Faction=affiche&amp;quoi=lexique.html">Lexique</a></span><span id="menu8" class="item"><a href="https://www.bibmath.net/forums/viewforum.php?id=6">Forum</a></span></section></div></nav><nav id="menumobile"><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="Analyse.class.html">Accueil</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme0"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert0"  style="display:none;"/></div></div><div class="itemmenumobileselectionne"><div class="teteitemmenumobile"><span><a href="javascript:affiche_sousmenumobile(1);">Méthodes anciennes</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme1"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert1"  style="display:none;"/></div><div class="sousmenumobile" id="sousmenumobile1"><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=substi%252Findex.html">Substitution monoalphabétique</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=poly%252Findex.html">Substitution polyalphabétique</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=ancienne%252Fpolygraphiqueindex.html">Chiffres polygraphiques</a></span></div><div class="sousitemmenumobile"><span><a href="https://www.bibmath.net/crypto/index.php?action=affiche&amp;quoi=ancienne/homophoneindex">Chiffres homophones</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=ancienne%252Ftranspoindex.html">Transposition</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=ancienne%252Fsurchiffrement.html">Surchiffrement</a></span></div></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="javascript:affiche_sousmenumobile(2);">Les 2 guerres</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme2"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert2"  style="display:none;"/></div><div class="sousmenumobile" id="sousmenumobile2"><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=debvingt%252Findexpremguerre.html">Première Guerre Mondiale</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=debvingt%252Findexsecguerre.html">Deuxième Guerre Mondiale</a></span></div></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="javascript:affiche_sousmenumobile(3);">Méthodes modernes</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme3"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert3"  style="display:none;"/></div><div class="sousmenumobile" id="sousmenumobile3"><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findex.html">Préambule</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findexclesecrete.html">Clé secrète</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findexclepublique.html">Clé publique</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findexprotocole.html">Protocoles</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findexconcret.html">Mises en oeuvre</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findexfutur.html">Futur</a></span></div></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="javascript:affiche_sousmenumobile(4);">Chasseurs de codes</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme4"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert4"  style="display:none;"/></div><div class="sousmenumobile" id="sousmenumobile4"><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=chasseur%252Findextheorie.html">Quelques principes</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=chasseur%252Findexvaincre.html">Quelques cas concrets</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=chasseur%252Findexoutils.html">Outils</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=chasseur%252Findexenigmes.html">Enigmes</a></span></div></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=stegano%252Findex.html">Stéganographie</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme5"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert5"  style="display:none;"/></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="javascript:affiche_sousmenumobile(6)">Compléments</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme6"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert6"  style="display:none;"/></div><div class="sousmenumobile" id="sousmenumobile6"><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=complements%252Findexfigures.html">Portraits</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=complements%252Findexmaths.html">Compléments mathématiques</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=complements%252Findexinfo.html">Compléments informatique</a></span></div><div class="sousitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=complements%252Findexclasse.html">En classe</a></span></div></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="index.php%3Faction=affiche&amp;quoi=lexique.html">Lexique</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme7"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert7"  style="display:none;"/></div></div><div class="itemmenumobile"><div class="teteitemmenumobile"><span><a href="https://www.bibmath.net/forums/viewforum.php?id=6">Forum</a></span><img src="img/flechemenumobileferme.png" id="sousmenumobileimageferme8"  /><img src="img/flechemenumobileouvert.png" id="sousmenumobileimageouvert8"  style="display:none;"/></div></div></nav></div><div id="main"><div style="width:100%"><div id="pubhaut"></div></div><div id="maincentre"><div id="gauche"><article id="contenugauche"><div class="chemin"><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Findex.html">Le plan de la partie : méthodes modernes de cryptographie</a> &gt; </div><h1>Les chiffrements par blocs - Leur modes opératoires</h1><div class=titrepartie>Les chiffrements par blocs</div>
&nbsp;&nbsp;Les chiffrements par blocs ont un principe très simple. Le texte initial est fragmenté en blocs de n bits.
Pour chaque bloc $x_i$ de n bits, l'algorithme de chiffrement est appliqué pour obtenir un bloc chiffré $y_i$ de même taille. 
On remet alors ensembles tous les blocs chiffrés séparément
pour obtenir le message chiffré. Pour le déchiffrement, on fragmente à nouveau le message en blocs de n bits, et pour chaque bloc
on applique l'algorithme de déchiffrement.</p>
&nbsp;&nbsp;Les plus célèbres algorithmes de chiffrement par blocs sont le DES et l'AES. Des modes opératoires
ont été standardisés pour décrire de quelle façon sont appliqués les chiffrements individuels de chaque bloc, 
en tenant compte de l'algorithme choisi et de la clé initiale. Nous les étudions maintenant. On suppose
donc qu'on a un algorithme $C_K$ de chiffrement appliqué à des blocs de taille n, $K$ étant la clé.
L'algorithme de déchiffrement associé est $D_L$.
<div class=titrepartie>Le mode ECB : carnet de codage électronique</div>
&nbsp;&nbsp;Le mode de chiffrement par carnet de codage électronique, qu'on trouve souvent appelé
mode ECB (de l'anglais <span class=rougedico>E</span>lectronic <span class=rougedico>C</span>ode <span class=rougedico>B</span>ook), est la façon
la plus simple de mettre en oeuvre un chiffrement par blocs. On partage le message initial en blocs $m_1m_2\dots m_r$ de taille n.
On calcule pour chaque bloc $c_i=C_K(m_i)$, et le message chiffré est simplement $c_1\dots c_n$.
Le déchiffrement se fait en calculant pour chaque bloc $D_L(c_i)$.</p>
&nbsp;&nbsp;Ce mode souffre de plusieurs défauts de sécurité :
<div class=liste>
<uL>
<li>Deux blocs clairs identiques sont chiffrés de la même façon. Ceci facilite les attaques statistiques, notamment
cela permet de repérer les blocs clairs utilisés les plus fréquemment.
<li>Le mode ECB ne respecte pas l'intégrité des données. Un attaquant peut remplacer certains blocs chiffrés par d'autres blocs
chiffrés du message, ou permuter deux blocs, sans que le destinataire s'en aperçoive. Imaginons que le message chiffré soit le montant
d'une transaction électronique, et que l'attaquant arrive à permuter deux chiffres!
</ul>
</div>
Pour ces raisons, l'utilisation du mode ECB n'est pas recommandée.

<div class=titrepartie>Le mode CBC : chiffrement par chaînage de blocs</div>
&nbsp;&nbsp;Le mode de chiffrement par chaînage de blocs, de l'anglais <span class=rougedico>C</span>ipher <span class=rougedico>B</span>lock
 <span class=rougedico>C</span>haining, évite les deux problèmes précédents, car désormais le chiffrement dépend du contexte. On commence par fixer
 un mot initial de $n$ bits $\bf V$, et on pose $c_0=\bf V$. Le message clair est toujours fractionné en $m_1m_2\dots m_r$. 
 Le chiffrement du i-ème bloc est alors obtenu par $c_i=C_K(c_{i-1}\oplus m_i)$. Ainsi, il dépend non seulement
 du i-ème bloc du message clair, mais aussi du message chiffré précédent.</p>
 &nbsp;&nbsp;Pour déchiffrer le message $c_1\dots c_r$, il faut aussi connaitre le mot initial $\mathbf V$. On calcule alors, pour chaque
 bloc $i$, $m_i=c_{i-1}\oplus D_L(c_i)$, et on peut prouver que $c_1\dots c_r$ est bien le message initial.</p>
 &nbsp;&nbsp;Ce mode a plusieurs avantages, et aussi un gros inconvénient. Le mode CBC chiffre le même message clair différemment avec des blocs
 d'initialisation différents. De plus, le chiffrement d'un bloc dépend également des blocs précédents, et par conséquent, si l'ordre des blocs du
 cryptogramme est modifié, le déchiffrement est impossible et le destinataire se rend compte du problème. De plus, 
 si une erreur de transmission affecte le bloc chiffré $c_i$, alors seuls les blocs $m_i$ et $m_{i+1}$ seront affectés, 
 les autres blocs seront déterminés correctement.</p>
 &nbsp;&nbsp;L'inconvénient principal de ce mode est sa lenteur. Imaginons que l'on veuille faire du chiffrement/déchiffrement en temps réel, et en simultané
 (cas par exemple d'une communication téléphonique) et
 que les algorithmes de chiffrement et de déchiffrement $C_K$ et $D_L$ soient assez longs à mettre en oeuvre. Alors 
 le destinataire, pour commencer le déchiffrement de $c_{i}$, doit attendre d'avoir terminé celui de $c_{i-1}$.
 Ainsi, le temps écoulé entre le chiffrement et le déchiffrement avec le mode CBC peut être trop long pour ce genre d'applications.</p>
 <center><img src="moderne/images/cbc.png"></center>
 
 <div class=titrepartie>Les modes CFB et OFB : chiffrement par rétroaction</div>
 &nbsp;&nbsp;Les modes de chiffrement de rétroaction (mode CFB, <span class=rougedico>C</span>ipher <span class=rougedico>F</span>eed <span class=rougedico>B</span>ack) et
 de rétroaction de sortie (mode OFB, <span class=rougedico>O</span>utput <span class=rougedico>F</span>eed <span class=rougedico>B</span>ack) ont un esprit très 
 différent des modes précédents. Il s'agit cette fois d'utiliser la fonction de chiffrement $C_K$ comme un générateur pseudo-aléatoire
 de clés, et en essayant de simuler un chiffrement par masque jetable (on n'est d'ailleurs plus vraiment avec ces
 deux modes plus vraiment dans le chiffrement par blocs, mais plutôt dans le chiffrement par flots).</p>
 &nbsp;&nbsp;Commençons par détailler le mode CFB. On applique l'algorithme suivant :
 <div class=liste>
 <ul>
 <li>on partage le texte en bloc de n bits $m_1m_2\dots m_r$. 
 <li>on se donne un bloc d'initialisation de $n$ bits $\mathbf V$, et on pose $z_1=\mathbf V$.
 Ce bloc $z_1$ est la première clé de contexte.
 <li>pour chaque bloc i, on calcule 
 <ol>
 <li>le bloc chiffré correspondant, par la formule $c_i=m_i\oplus z_i$;
 <li>la clé de contexte suivante, par la formule $z_{i+1}=C_K(c_i)$.
 </ol>
 </ul>
 </div>
 Pour le déchiffrement, on utilise exactement le même algorithme, mais cette fois on retrouve le message initial par la formule
 $m_i=c_i\oplus z_i$. Avec le mode CFB, on retrouve certaines propriétés du mode CBC, comme par exemple le fait
 que la modification d'un bloc de texte clair entraîne la modification de tous les blocs chiffrés à partir de celui-ci,
 faisant de ce mode un mode parfaitement adapté pour préserver l'intégrité des messages.</p>
&nbsp;&nbsp; Le fonctionnement du mode OFB est tout à fait similaire, mais on applique l'algorithme de chiffrement directement aux clés de contexte :
 <div class=liste>
 <ul>
 <li>on partage le texte en bloc de n bits $m_1m_2\dots m_r$. 
 <li>on se donne un bloc d'initialisation de $n$ bits $\mathbf V$, et on pose $z_1=\mathbf V$.
 Ce bloc $z_1$ est la première clé de contexte.
 <li>pour chaque bloc i, on calcule 
 <ol>
 <li>le bloc chiffré correspondant, par la formule $c_i=m_i\oplus z_i$;
 <li>la clé de contexte suivante, par la formule $z_{i+1}=C_K(z_i)$.
 </ol>
 </ul>
 </div>
 Ainsi, après s'être mis d'accord sur le bloc d'initialisation, l'émetteur et le récepteur peuvent calculer simultanément, et indépendamment
 de l'envoi des messages chiffrés, la suite des clés de contexte. Le calcul du "ou exclusif" est lui très rapide et peut se faire
 facilement en temps réel. Ceci fait du mode OFB un mode bien adapté à ce type d'utilisation, d'autant que la modification d'un 
 bloc du message clair n'entraîne que la modification de ce bloc du message chiffré.</p>
 &nbsp;&nbsp;Dans les modes CFB et OFB, le bloc d'initialisation $\mathbf V$ ne doit pas nécessairement être secret.
 En revanche, il doit être à usage unique. En effet, si on utilise deux fois le même bloc d'initialisation,
 on obtient les mêmes problèmes qu'en utilisant deux fois la même clé dans le chiffrement par masque jetable.</p>
 
 &nbsp;&nbsp;Nous avons décrit ici la version simplifiée des modes CFB et OFB. On peut les utiliser aussi en partageant le message initial
 avec des blocs plus petits que la taille des blocs de l'algorithme de chiffrement. L'algorithme de fabrication des clés de contexte est alors
 légèrement modifié. L'algorithme AES est de plus en plus utilisé avec ces deux modes dans les protocoles de communication comme
 le wifi, bluetooth ou la téléphonie mobile, où il remplace des algorithmes de chiffrement par flots comme RC4.</p> 
<div class=titrepartie>Consulter aussi</div><div class=liste><ul><li><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Fdes.html">Description du DES</a></li><li><a href="index.php%3Faction=affiche&amp;quoi=moderne%252Fvernam.html">Le chiffrement par masque jetable</a></li></ul></div></article></div><aside id="droite"><div id="pubdroite"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:600px"
     data-ad-client="ca-pub-5238512654171693"
     data-ad-slot="3610567220"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></aside></div></div><footer id="pied"><div id="piedcentre"><section id="listepied"><span class="item"><a href="contact.php%3Forigine=erreur.html">Signaler une erreur, une faute d'orthographe</a></span><span class="item"><a href="contact.php%3Forigine=contribuer.html">Contribuer au site</a></span><span class="item"><a href="credits.php.html">Crédits</a></span></section></div></footer><footer id="piedmobile"><span class="item"><script language="JavaScript1.1"> <!-- 
	hsh = new Date();
      hsd = document;
      hsi = '<a href="http://www.xiti.com/xiti.asp?s=65164"'
      hsi += ' TARGET="_top"><img width="80" height="15" border=0 '
      hsi += 'src="http://logv17.xiti.com/oco.xiti?s=65164'
      hsi += '&p=&hl=' + hsh.getHours() + 'x' + hsh.getMinutes() + 'x' + hsh.getSeconds();
      if(parseFloat(navigator.appVersion)>=4)
            {Xiti_s=screen;hsi += '&r=' + Xiti_s.width + 'x' + Xiti_s.height + 'x' + Xiti_s.pixelDepth + 'x' + Xiti_s.colorDepth;}
      hsd.writeln(hsi + '&ref=' + hsd.referrer.replace('&', '$') + ' " title="Mesurez votre audience"></a>');//-->  
      </script></span><span class="item"><a href="contact.php%3Forigine=mobile.html">Nous contacter</a></span></footer></body><script type="text/javascript" src="common/scrolling.js"></script></html>   